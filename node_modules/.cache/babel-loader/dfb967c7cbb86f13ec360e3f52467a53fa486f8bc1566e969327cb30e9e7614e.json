{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\n/* eslint-disable */\nimport { msgError, msgSuccess } from '../../Tools/vuex';\nimport fbErrors from '../../Tools/fbcodes';\nimport { createUserWithEmailAndPassword, signInWithEmailAndPassword } from 'firebase/auth';\nimport { doc, setDoc, getDoc } from 'firebase/firestore';\nimport { db, auth } from '../../firebase';\nimport router from '../../routes';\nconst DEFAULT_USER = {\n  uid: null,\n  email: null,\n  firstname: null,\n  lastname: null,\n  isAdmin: null\n};\nconst authModule = {\n  namespaced: true,\n  state() {\n    return {\n      user: DEFAULT_USER,\n      auth: false\n    };\n  },\n  getters: {\n    isAuth(state) {\n      if (state.auth) {\n        return true;\n      }\n      ;\n      return false;\n    },\n    isAdmin(state) {\n      if (state.user.isAdmin) {\n        return true;\n      }\n      ;\n      return true;\n    },\n    getUserData(state) {\n      return state.user;\n    }\n  },\n  mutations: {\n    setUser(state, payload) {\n      state.user = {\n        ...state.user,\n        ...payload\n      };\n      state.auth = true;\n    },\n    clearUser(state) {\n      state.user = DEFAULT_USER;\n      state.auth = false;\n    }\n  },\n  actions: {\n    async signOut({\n      commit\n    }) {\n      try {\n        await auth.signOut();\n        commit('clearUser');\n      } catch (error) {\n        console.log(error);\n      }\n    },\n    async autosign({\n      commit,\n      dispatch\n    }, payload) {\n      try {\n        const userData = await dispatch('getUserProfile', payload.uid);\n        commit('setUser', userData);\n        return true;\n      } catch (error) {\n        console.log(error);\n      }\n    },\n    async getUserProfile({\n      commit\n    }, payload) {\n      try {\n        const docSnap = await getDoc(doc(db, 'users', payload));\n        if (docSnap.exists()) {\n          return docSnap.data();\n        } else {\n          return null;\n        }\n      } catch (error) {\n        console.log(error);\n      }\n    },\n    async signin({\n      commit,\n      dispatch\n    }, payload) {\n      try {\n        commit('notify/setLoading', true, {\n          root: true\n        });\n        const userCredential = await signInWithEmailAndPassword(auth, payload.email, payload.password);\n        const userData = await dispatch('getUserProfile', userCredential.user.uid);\n        commit('setUser', userData);\n        router.push('/user/dashboard');\n      } catch (error) {\n        console.log(error);\n      } finally {\n        commit('notify/setLoading', false, {\n          root: true\n        });\n      }\n    },\n    async signup({\n      commit\n    }, payload) {\n      try {\n        commit('notify/setLoading', true, {\n          root: true\n        });\n        const userCredential = await createUserWithEmailAndPassword(auth, payload.email, payload.password);\n        const newUser = {\n          uid: userCredential.user.uid,\n          email: userCredential.user.email,\n          isAdmin: false /// warning -  cloud function\n        };\n\n        await setDoc(doc(db, 'users', userCredential.user.uid), newUser);\n        commit('setUser', newUser);\n        msgSuccess(commit, 'Welcome !!');\n        router.push('/user/dashboard');\n      } catch (error) {\n        msgError(commit, fbErrors(error.code));\n      } finally {\n        commit('notify/setLoading', false, {\n          root: true\n        });\n      }\n    }\n  }\n};\nexport default authModule;","map":{"version":3,"names":["msgError","msgSuccess","fbErrors","createUserWithEmailAndPassword","signInWithEmailAndPassword","doc","setDoc","getDoc","db","auth","router","DEFAULT_USER","uid","email","firstname","lastname","isAdmin","authModule","namespaced","state","user","getters","isAuth","getUserData","mutations","setUser","payload","clearUser","actions","signOut","commit","error","console","log","autosign","dispatch","userData","getUserProfile","docSnap","exists","data","signin","root","userCredential","password","push","signup","newUser","code"],"sources":["C:/Users/Ball/OneDrive/Documents/Web dev/own-website/src/Store/auth/index.js"],"sourcesContent":["\r\n/* eslint-disable */\r\nimport { msgError, msgSuccess } from '../../Tools/vuex';\r\nimport fbErrors from '../../Tools/fbcodes';\r\nimport {\r\n    createUserWithEmailAndPassword,\r\n    signInWithEmailAndPassword\r\n} from 'firebase/auth';\r\nimport { doc, setDoc, getDoc } from 'firebase/firestore';\r\nimport { db, auth } from '../../firebase';\r\nimport router from '../../routes';\r\n\r\n\r\nconst DEFAULT_USER = {\r\n    uid:null,\r\n    email:null,\r\n    firstname:null,\r\n    lastname:null,\r\n    isAdmin:null\r\n}\r\n\r\n\r\nconst authModule = {\r\n    namespaced:true,\r\n    state(){\r\n        return {\r\n            user:DEFAULT_USER,\r\n            auth:false\r\n        }   \r\n    },\r\n    getters:{\r\n        isAuth(state){\r\n            if(state.auth) { return true};\r\n            return false\r\n        },\r\n        isAdmin(state){\r\n            if(state.user.isAdmin) { return true};\r\n            return true\r\n        },\r\n        getUserData(state){\r\n            return state.user;\r\n        }\r\n    },\r\n    mutations:{\r\n        setUser(state,payload){\r\n            state.user = {\r\n                ...state.user,\r\n                ...payload\r\n            }\r\n            state.auth = true;\r\n        },\r\n        clearUser(state){\r\n            state.user = DEFAULT_USER;\r\n            state.auth = false;\r\n        }\r\n    },\r\n    actions:{\r\n        async signOut({commit}){\r\n            try{\r\n                await auth.signOut();\r\n                commit('clearUser');\r\n            } catch(error){\r\n                console.log(error)\r\n            }\r\n        },\r\n        async autosign({commit,dispatch},payload){\r\n            try {\r\n                const userData = await dispatch('getUserProfile',payload.uid);\r\n                commit('setUser', userData);\r\n                return true;\r\n            } catch(error){\r\n                console.log(error)\r\n            }\r\n        },\r\n        async getUserProfile({commit},payload){\r\n            try{\r\n                const docSnap = await getDoc(doc(db,'users',payload));\r\n\r\n                if(docSnap.exists()){\r\n                    return docSnap.data();\r\n                } else {\r\n                    return null\r\n                }\r\n            } catch(error){\r\n                console.log(error)\r\n            }\r\n        },\r\n        async signin({commit,dispatch},payload){\r\n            try {\r\n                commit('notify/setLoading',true,{ root: true })\r\n                const userCredential = await signInWithEmailAndPassword(\r\n                    auth,\r\n                    payload.email,\r\n                    payload.password\r\n                );\r\n                \r\n                const userData = await dispatch('getUserProfile',userCredential.user.uid);\r\n                commit('setUser',userData);\r\n\r\n                router.push('/user/dashboard');                \r\n            } catch(error){\r\n                console.log(error)\r\n            } finally{\r\n                commit('notify/setLoading',false,{ root: true })\r\n            }\r\n            \r\n        },\r\n        async signup({commit},payload){\r\n            try{\r\n                commit('notify/setLoading',true,{ root: true })\r\n                const userCredential = await createUserWithEmailAndPassword(\r\n                    auth,\r\n                    payload.email,\r\n                    payload.password\r\n                );\r\n\r\n                const newUser = {\r\n                    uid:userCredential.user.uid,\r\n                    email:userCredential.user.email,\r\n                    isAdmin:false /// warning -  cloud function\r\n                }\r\n                await setDoc(doc(db,'users',userCredential.user.uid),newUser);\r\n                commit('setUser',newUser);\r\n\r\n                msgSuccess(commit,'Welcome !!')\r\n                router.push('/user/dashboard');    \r\n            }catch(error){\r\n                msgError(commit,fbErrors(error.code));\r\n            } finally{\r\n                commit('notify/setLoading',false,{ root: true })\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nexport default authModule;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}